<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>创建连接 URL</title><meta name="Language" content="zh-CN" /><meta name="System.Keywords" content="连接 URL" /><meta name="Microsoft.Help.Id" content="44996746-d373-4f59-9863-a8a20bb8024a" /><meta name="Description" content="连接 URL 的一般形式为：" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">创建连接 URL</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>连接 URL 的一般形式为：</p><p><span class="code">jdbc:sqlserver://[serverName[\instanceName][:portNumber]][;property=value[;property=value]]</span></p><p>其中：</p><ul><li><p><span class="label">jdbc:sqlserver://</span>（必需）称为子协议，且为常数。</p></li><li><p><span class="label">serverName</span>（可选）是要连接到的服务器的地址。它可以是 DNS 或 IP 地址，也可以是本地计算机地址 localhost 或 127.0.0.1。如果未在连接 URL 中指定服务器名称，则必须在属性集中指定。</p></li><li><p><span class="label">instanceName</span> （可选）是 serverName 上要连接到的实例。如果未指定，则会连接到默认实例。</p></li><li><p><span class="label">portNumber</span>（可选）是 serverName 上要连接到的端口。默认值为 1433。如果使用默认端口，则无需在 URL 中指定端口及其前面的“:”。</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>若要获得最佳连接性能，应在连接到指定实例时设置 portNumber。这将避免为了确定端口号而与服务器进行往返通讯。如果同时使用 portNumber 和 instanceName，则会优先使用 portNumber，而忽略 instanceName。</p></div></li><li><p><span class="label">property</span>（可选）是一个或多个选项连接属性。有关详细信息，请参阅<span sdata="link"><a href="f1b62700-f046-488d-bd6b-a5cd8fc345b7.htm">设置连接属性</a></span>。可指定该列表中的任何属性。属性只能用分号（“;”）分隔，且不允许重复。</p></li></ul><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>出于安全考虑，应避免根据用户输入的内容创建连接 URL。只应在 URL 中指定服务器名称和驱动程序。对于用户名和密码值，请使用连接属性集。有关 JDBC 应用程序中安全性的详细信息，请参阅<span sdata="link"><a href="90724ec6-a9cb-43ef-903e-793f89410bc0.htm">保护 JDBC Driver 应用程序</a></span>。</p></div></div><h1 class="heading">连接实例</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>使用用户名和密码连接到本地计算机上的默认数据库：</p><p><span class="code">jdbc:sqlserver://localhost;user=MyUserName;password=*****;</span></p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>尽管以上实例在连接字符串中使用了用户名和密码，但如果在 Windows 操作系统中运行应用程序，则应使用集成安全性，因为这样会更加安全。有关详细信息，请参阅本主题后面部分的<a href="#Connectingintegrated">通过集成身份验证进行连接</a>一节。</p></div><p>使用集成身份验证连接到本地计算机上的默认数据库：</p><p><span class="code">jdbc:sqlserver://localhost;integratedSecurity=true;</span></p><p>连接到远程服务器上的指定数据库：</p><p><span class="code">jdbc:sqlserver://localhost;databaseName=AdventureWorks;integratedSecurity=true;</span></p><p>连接到远程服务器上的默认端口：</p><p><span class="code">jdbc:sqlserver://localhost:1433;databaseName=AdventureWorks;integratedSecurity=true;</span></p><p>通过指定自定义应用程序名称进行连接：</p><p><span class="code">jdbc:sqlserver://localhost;databaseName=AdventureWorks;integratedSecurity=true;applicationName=MyApp;</span></p></div><h1 class="heading">指定的多个 SQL Server 实例</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>SQL Server 允许在每台服务器上安装多个数据库实例。每个实例都由一个专用名称所标识。若要连接到指定的 SQL Server 实例，可以使用指定实例的端口号（首选），也可将实例名指定为 JDBC URL 属性或 <span class="label">datasource</span> 属性。如果未指定实例名属性或端口号属性，则会创建与默认实例的连接。如以下实例所示：</p><p>若要使用端口号，请执行下列操作：</p><p><span class="code">jdbc:sqlserver://localhost:1433;integratedSecurity=true;&lt;more properties as required&gt;;</span></p><p>若要使用 JDBC URL 属性，请执行下列操作：</p><p><span class="code">jdbc:sqlserver://localhost;instanceName=instance1;integratedSecurity=true;&lt;more properties as required&gt;;</span></p></div><h1 class="heading">转义连接 URL 中的值</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>由于包含特殊字符（如空格、分号和引号），所以必须转义连接 URL 值的某些部分。如果这些字符包含在大括号中，则 JDBC 驱动程序将支持对其进行转义。例如，{;} 将转义分号。</p><p>转义的值可以包含特殊字符（特别是“=”、“;”、“[]”和空格），但不能包含大括号。应将必须进行转义且包含大括号的值添加到属性集中。</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>大括号内的空白为原义字符，不能删除。</p></div></div><a name="Connectingintegrated"> </a><h1 class="heading">通过集成身份验证进行连接</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>有关 Microsoft JDBC Driver for SQL Server 中还允许应用程序使用集成身份验证连接到数据库的新增功能的说明，请参阅<span sdata="link"><a href="687802dc-042a-4363-89aa-741685d165b3.htm">使用 Kerberos 集成身份验证连接到 SQL Server</a></span>。</p><p>JDBC 驱动程序支持通过 integratedSecurity 连接字符串属性在 Windows 操作系统上使用“类型 2”集成身份验证。若要使用集成身份验证，请将 sqljdbc_auth.dll 文件复制计算机中 Windows 系统路径下的 JDBC 驱动程序安装目录中。</p><p>sqljdbc_auth.dll 文件的安装位置如下：</p><p>&lt;<span class="placeholder">installation directory</span>&gt;\sqljdbc_&lt;<span class="placeholder">version</span>&gt;\&lt;<span class="placeholder">language</span>&gt;\auth\</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>如果您运行 32 位的 Java 虚拟机 (JVM)，则使用 x86 文件夹中的 sqljdbc_auth.dll 文件，即使操作系统是 x64 版本也不例外。如果您在 x64 处理器上运行 64 位 JVM，则使用 x64 文件夹中的 sqljdbc_auth.dll 文件。</p></div><p>也可以设置 java.libary.path 系统属性以指定 sqljdbc_auth.dll 的目录。例如，如果 JDBC Driver 安装在默认目录中，您可以在 Java 应用程序启动时使用以下虚拟机 (VM) 参数来指定 DLL 的位置：</p><p><span class="code">-Djava.library.path=C:\Microsoft JDBC Driver 4.0 for SQL Server\sqljdbc_&lt;version&gt;\enu\auth\x86</span></p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>运行于非 Windows 操作系统上的 JDBC Driver 不支持集成身份验证。从非 Windows 操作系统连接到 SQL Server 时，该驱动程序还不提供支持 Windows 身份验证凭据（如用户名和密码）的功能。在这种情况下，应用程序必须改用 SQL Server 身份验证。</p></div></div><h1 class="heading">通过 IPv6 地址进行连接</h1><div id="sectionSection4" class="section" name="collapseableSection" style=""><p>JDBC 驱动程序支持使用具有连接属性集合和 serverName 连接字符串属性的 IPv6 地址。连接字符串不支持在 IPv6 地址中使用初始 serverName 值，如 jdbc:<span class="placeholder">sqlserver</span>://<span class="placeholder">serverName</span>。使用 <span class="placeholder">serverName</span> 的名称而不是原始 IPv6 地址将适用于连接中的所有情况。以下实例提供了详细信息。</p><p><span class="label">使用 serverName 属性</span></p><p><span class="code">jdbc:sqlserver://;serverName=3ffe:8311:eeee:f70f:0:5eae:10.203.31.9\\instance1;integratedSecurity=true;</span></p><p><span class="label">使用属性集合</span></p><p><span class="code">Properties pro = new Properties();</span></p><p><span class="code">pro.setProperty("serverName", "serverName=3ffe:8311:eeee:f70f:0:5eae:10.203.31.9\\instance1");</span></p><p><span class="code">Connection con = DriverManager.getConnection("jdbc:sqlserver://;integratedSecurity=true;", pro);</span></p></div><span id="seeAlsoSpan"><h1 class="heading">请参阅</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="94bcfbe3-f00e-4774-bda8-bb7577518fec.htm">通过 JDBC 驱动程序连接到 SQL Server</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">发送有关本主题的<a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\d感谢您提供反馈。开发人员写作组将利用您的反馈来改进文档质量。我们在审阅您的反馈时，可能会给您发送电子邮件提出问题或询问您对某个解决方案的意见。您的电子邮件地址不会被用于其他用途，我们在完成审阅之后即会将其删除。%0\A有关%20Microsoft%20隐私策略的其他信息，请参阅%20http://privacy.microsoft.com/zh-CN/default.aspx。%0\A%0\d','客户反馈');">反馈</a>至 Microsoft。</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft。保留所有权利。</a></p></span></div></div></body></html>